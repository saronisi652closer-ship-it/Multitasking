<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>趣味管理アプリ</title>

<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#0b0c10">

<style>
:root{
--bg:#0b0c10;
--card:#14161d;
--muted:#aeb5c3;
--text:#eef2ff;
--accent:#6ee7b7;
--line:#24283a;
}
*{box-sizing:border-box}
body{
margin:0;
font-family:system-ui,-apple-system,"Noto Sans JP",sans-serif;
background:var(--bg);
color:var(--text);
overflow-x:hidden;
}
.wrap{max-width:100%;padding:12px}
.card{
background:var(--card);
border:1px solid var(--line);
border-radius:18px;
padding:14px;
margin-bottom:16px;
}
input,textarea,select,button{
font:inherit;
color:var(--text);
background:#0f1117;
border:1px solid var(--line);
border-radius:12px;
padding:10px;
width:100%;
}
textarea{min-height:80px}
button.primary{background:rgba(110,231,183,.15)}
button.danger{background:rgba(255,80,100,.15)}

.row{display:flex;gap:8px;flex-wrap:wrap}
.two{display:grid;grid-template-columns:1fr;gap:8px}
.three{display:grid;grid-template-columns:1fr;gap:8px}
.six{display:grid;grid-template-columns:repeat(3,1fr);gap:6px}

@media(max-width:420px){
.six{grid-template-columns:repeat(2,1fr)}
}

.teamtab{
padding:6px 12px;
border-radius:999px;
border:1px solid var(--line);
background:#0f1117;
color:var(--muted);
white-space:nowrap;
}
.teamtab.active{
background:rgba(110,231,183,.15);
color:var(--text);
}

</style>
</head>

<body>
<div class="wrap">

<div class="card">
<h3>ポケモン登録</h3>

<input id="pname" placeholder="ポケモン名">
<input id="pokeTeam" placeholder="チーム名">

<div class="six">
<div><input id="evH" placeholder="H"></div>
<div><input id="evA" placeholder="A"></div>
<div><input id="evB" placeholder="B"></div>
<div><input id="evC" placeholder="C"></div>
<div><input id="evD" placeholder="D"></div>
<div><input id="evS" placeholder="S"></div>
</div>

<div class="row">
<select id="evPreset">
<option value="">EVテンプレを選択</option>
<option value="H4,A252,S252">H4 A252 S252</option>
<option value="H252,B252,D4">H252 B252 D4</option>
</select>
<button id="btnApplyPreset">テンプレ適用</button>
</div>

<input id="iv" placeholder="例：H31 A31 B31 C31 D31 S31">

<div class="row">
<button id="btnIVAll31">全V(31)</button>
<button id="btnIVS0">S0</button>
<button id="btnIVA0">A0</button>
<button id="btnIVC0">C0</button>
<button id="btnIVClear">IVクリア</button>
</div>

<button class="primary" id="btnSave">保存</button>
</div>

<div class="card">
<h3>ポケモン一覧</h3>

<div id="teamTabs" class="row"></div>

<select id="pokeFilterTeam">
<option value="">チーム：すべて</option>
</select>

<div id="pokeList"></div>
</div>

</div>

<script>
const $=id=>document.getElementById(id)
let pokeDB=JSON.parse(localStorage.getItem("pokeDB")||"[]")
let activeTeamTab=""

const evPreset=$("evPreset")
const btnApplyPreset=$("btnApplyPreset")
const iv=$("iv")

btnApplyPreset.onclick=()=>{
const v=evPreset.value
if(!v)return
const map={H:0,A:0,B:0,C:0,D:0,S:0}
v.split(",").forEach(p=>{
const key=p.charAt(0)
const num=parseInt(p.slice(1))
if(map.hasOwnProperty(key))map[key]=num
})
$("evH").value=map.H
$("evA").value=map.A
$("evB").value=map.B
$("evC").value=map.C
$("evD").value=map.D
$("evS").value=map.S
}

$("btnIVAll31").onclick=()=>iv.value="H31 A31 B31 C31 D31 S31"
$("btnIVS0").onclick=()=>iv.value+=" / S0"
$("btnIVA0").onclick=()=>iv.value+=" / A0"
$("btnIVC0").onclick=()=>iv.value+=" / C0"
$("btnIVClear").onclick=()=>iv.value=""

$("btnSave").onclick=()=>{
const data={
id:Date.now(),
name:$("pname").value,
team:$("pokeTeam").value,
ev:{
H:$("evH").value,
A:$("evA").value,
B:$("evB").value,
C:$("evC").value,
D:$("evD").value,
S:$("evS").value
},
iv:iv.value
}
pokeDB.unshift(data)
localStorage.setItem("pokeDB",JSON.stringify(pokeDB))
render()
}

function render(){
renderTabs()
renderList()
}

function renderTabs(){
const teamTabs=$("teamTabs")
const teams=[...new Set(pokeDB.map(x=>x.team||""))]
teamTabs.innerHTML=""

const create=(key,label)=>{
const btn=document.createElement("button")
btn.textContent=label
btn.className="teamtab"+(activeTeamTab===key?" active":"")
btn.onclick=()=>{activeTeamTab=key;render()}
teamTabs.appendChild(btn)
}

create("","すべて")
create("__UNSET__","未設定")
teams.filter(t=>t).forEach(t=>create(t,t))
}

function renderList(){
const list=$("pokeList")
list.innerHTML=""
let items=pokeDB.slice()

if(activeTeamTab==="__UNSET__"){
items=items.filter(x=>!x.team)
}else if(activeTeamTab){
items=items.filter(x=>x.team===activeTeamTab)
}

items.forEach(p=>{
const div=document.createElement("div")
div.style.marginBottom="10px"
div.innerHTML="<b>"+p.name+"</b><br>チーム："+(p.team||"未設定")+"<br>EV H"+p.ev.H+" A"+p.ev.A+" B"+p.ev.B+" C"+p.ev.C+" D"+p.ev.D+" S"+p.ev.S+"<br>IV："+p.iv
list.appendChild(div)
})
}

render()
</script>
</body>
</html>
